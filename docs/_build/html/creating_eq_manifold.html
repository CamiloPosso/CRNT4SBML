

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Creating the Equilibrium Manifold &mdash; CRNT4SBML 0.0.4 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/copybutton.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Generating Presentable C-graphs" href="generating_c_graphs.html" />
    <link rel="prev" title="Numerical Continuation Routine" href="numerical_cont.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> CRNT4SBML
          

          
          </a>

          
            
            
              <div class="version">
                0.0.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">CRNT4SBML</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="detect_bistability.html">Steps for Detecting Bistability</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="physiological_bounds.html">Creating Physiological Bounds</a></li>
<li class="toctree-l1"><a class="reference internal" href="celldesigner_walkthrough.html">CellDesigner Walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_crnt.html">Low Deficiency Approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="deficiency_walkthrough.html">Mass Conservation Approach Walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="injectivity_walkthrough.html">Semi-diffusive Approach Walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="numerical_opt.html">Numerical Optimization Routine</a></li>
<li class="toctree-l1"><a class="reference internal" href="numerical_cont.html">Numerical Continuation Routine</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Creating the Equilibrium Manifold</a></li>
<li class="toctree-l1"><a class="reference internal" href="generating_c_graphs.html">Generating Presentable C-graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="more_examples.html">Further Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="zbibliography.html">Bibliography</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CRNT4SBML</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Creating the Equilibrium Manifold</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/creating_eq_manifold.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="creating-the-equilibrium-manifold">
<span id="manifold-label"></span><h1>Creating the Equilibrium Manifold<a class="headerlink" href="#creating-the-equilibrium-manifold" title="Permalink to this headline">¶</a></h1>
<p>For the mass conservation approach of <a class="reference internal" href="zbibliography.html#irene" id="id1">[OMYS17]</a> there are multiple ways that one can form the equilibrium manifold,
<img class="math" src="_images/math/a003c27510b6d1520296d638c96f797699405883.png" alt="H (\alpha, c, k)"/>. In the approach we have constructed, we have chosen the equilibrium manifold
that will result in two characteristics. The first of which is that the decision vector ultimately chosen will
consist of only kinetic constants and species’ concentrations. The reason for this is that we would like to remove the
need for the user to provide bounds on the so called deficiency parameters, <img class="math" src="_images/math/877d234f4cec6974ce218fc2e975a486a7972dfd.png" alt="\alpha"/>. These bounds in practice can
be somewhat difficult to find as they are not tied to any physical aspect of the network. The second characteristic we
impose is that the manifold will be as close as possible to being linear with respect to the deficiency parameters and
those species not in the decision vector. If the manifold is close to being linear in these variables, then solving for
them is much simpler resulting in a shorter solve time for SymPy’s solve function and the avoidance of unsolvable
instances of the problem.</p>
<p>We now describe the process taken to find the decision vector and resulting equilibrium manifold. As stated in <a class="reference internal" href="zbibliography.html#irene" id="id2">[OMYS17]</a>,
the choice of the decision vector is as follows:</p>
<p><img class="math" src="_images/math/be2ff73acd1eb8a5ced3e773f4bf6a5a01e19654.png" alt="x = (k_1, ..., k_R, \alpha_1, ..., \alpha_\lambda)"/> for proper and over-dimensioned networks</p>
<p>and</p>
<p><img class="math" src="_images/math/996dede370d0fda463081ad6572c1dcebd28d3e9.png" alt="x = (k_1, ..., k_R, \alpha_1, ..., \alpha_\delta, c_1, ..., c_{\lambda - \delta})"/> for under-dimensioned networks.</p>
<p>Although these decision vectors can be used, it is apparent that if they are chosen then the user will need to provide
bounds for the deficiency parameters, <img class="math" src="_images/math/877d234f4cec6974ce218fc2e975a486a7972dfd.png" alt="\alpha"/>. However, as can be inferred by the statement on the bottom of page
7 in the S1 Appendix of <a class="reference internal" href="zbibliography.html#irene" id="id3">[OMYS17]</a>, as long as the parameters <img class="math" src="_images/math/877d234f4cec6974ce218fc2e975a486a7972dfd.png" alt="\alpha"/> and <img class="math" src="_images/math/0b7c1e16a3a8a849bb8ffdcdbf86f65fd1f30438.png" alt="k"/> are fixed and we can form
equation (2.7), then the results of Proposition 1 of page 8 follow. This allows one to choose the decision vector to
be as follows for proper and over/under - dimensioned networks:</p>
<p><img class="math" src="_images/math/8017b33b75d2ffcd9d5e339a6f4efbdcb4c8101d.png" alt="x = (k_1, ..., k_R, \theta_1, ..., \theta_\lambda)"/>,</p>
<p>where the <img class="math" src="_images/math/3be04d4207434584251f6921820c24ac9fa8c6f1.png" alt="\theta"/> values are nonidentical choices of the species’ concentrations, <img class="math" src="_images/math/ae12a24f88803b5895632e4848d87d46483c492c.png" alt="c"/>.</p>
<p>Now that we have reformed the decision vector to be in terms of just kinetic constants and species’ concentrations, the
next step is to choose the <img class="math" src="_images/math/3be04d4207434584251f6921820c24ac9fa8c6f1.png" alt="\theta"/> values such that the equilibrium manifold is as close to being linear as possible.
To do this, we first generate <img class="math" src="_images/math/aedbcafa5b7755ec7c36208fcdd693a7ca78f5fa.png" alt="\frac{N!}{s! (N-s)!}"/> choices of <img class="math" src="_images/math/3be04d4207434584251f6921820c24ac9fa8c6f1.png" alt="\theta"/> values using <img class="math" src="_images/math/ce773a2d5f57e2c8791a1290d664cdc4a6827d76.png" alt="{N \choose s}"/>,
where <img class="math" src="_images/math/f4170ed8938b79490d8923857962695514a8e4cb.png" alt="N"/> is the number of species and <img class="math" src="_images/math/63751cb2e98ba393b0f22e45ca127c3cebb61487.png" alt="s"/> is the rank of the stoichiometric matrix. Using each of these
sets of <img class="math" src="_images/math/3be04d4207434584251f6921820c24ac9fa8c6f1.png" alt="\theta"/> values, we then test how many rows of (9) in <a class="reference internal" href="zbibliography.html#irene" id="id4">[OMYS17]</a> are linear in those species’ concentrations
that are not in <img class="math" src="_images/math/3be04d4207434584251f6921820c24ac9fa8c6f1.png" alt="\theta"/> by testing if the second order derivatives of the expression in the row is zero. This is
essentially testing if the expression is jointly linear with respect to a given set of species’ concentrations not in
<img class="math" src="_images/math/3be04d4207434584251f6921820c24ac9fa8c6f1.png" alt="\theta"/>.</p>
<p>In practice going through all <img class="math" src="_images/math/aedbcafa5b7755ec7c36208fcdd693a7ca78f5fa.png" alt="\frac{N!}{s! (N-s)!}"/> choices can be expensive for large networks, to reduce this
runtime we exit this routine if all rows of (9) are linear in those species’ concentrations not in <img class="math" src="_images/math/3be04d4207434584251f6921820c24ac9fa8c6f1.png" alt="\theta"/> and
choose this set of <img class="math" src="_images/math/3be04d4207434584251f6921820c24ac9fa8c6f1.png" alt="\theta"/> variables for our decision vector. After choosing the set of <img class="math" src="_images/math/3be04d4207434584251f6921820c24ac9fa8c6f1.png" alt="\theta"/> variables,
we then choose <img class="math" src="_images/math/a003c27510b6d1520296d638c96f797699405883.png" alt="H (\alpha, c, k)"/> by selecting <img class="math" src="_images/math/d0e1e7422cb6c0cf76242ef109a9f38c51d93dbb.png" alt="M - \ell"/> independent rows of (9). This process of selecting
<img class="math" src="_images/math/a003c27510b6d1520296d638c96f797699405883.png" alt="H (\alpha, c, k)"/> is reflected in the run of crnt4sbml by the following output produced by
<a class="reference internal" href="classes/crnt4sbml.CRNT.html#crnt4sbml.CRNT.get_mass_conservation_approach" title="crnt4sbml.CRNT.get_mass_conservation_approach"><code class="xref py py-func docutils literal notranslate"><span class="pre">crnt4sbml.CRNT.get_mass_conservation_approach()</span></code></a></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Creating Equilibrium Manifold ...
Elapsed time for creating Equilibrium Manifold: xx
</pre></div>
</div>
<p>Once we have selected the equilibrium manifold, we then use the manifold to solve for all the deficiency parameters and
species’ concentrations not in <img class="math" src="_images/math/3be04d4207434584251f6921820c24ac9fa8c6f1.png" alt="\theta"/> using SymPy’s solve function. This allows us to create expressions for each
species’ concentration. This process may take several minutes, so we have provided the following output to the screen
to aid the user:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Solving for species&#39; concentrations ...
Elapsed time for finding species&#39; concentrations: xx
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="generating_c_graphs.html" class="btn btn-neutral float-right" title="Generating Presentable C-graphs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="numerical_cont.html" class="btn btn-neutral float-left" title="Numerical Continuation Routine" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Brandon Reyes

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>